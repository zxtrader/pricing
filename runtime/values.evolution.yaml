environment: evolution

application:
  processing:
    serviceImage: devdocker.infra.kube/cryptopay/cpservice-devel
    tag: 2.0.2-alpha
    tag: latest
    # args:
    #   [
    #     "--config-file=/etc/cexiolabs/cryptopay.processing/service.config",
    #     "--config-toml-file=/etc/cexiolabs/cryptopay.processing/service.toml",
    #     "--config-secrets-dir=/etc/cexiolabs/cryptopay/secrets",
    #     "--config-secrets-dir=/etc/cexiolabs/cryptopay/secrets-setup",
    #     "--config-env"
    #   ]
    env:
      SSL_CERT_FILE: /etc/cexiolabs/cryptopay/ssl/tls.crt
      SSL_KEY_FILE: /etc/cexiolabs/cryptopay/ssl/tls.key
      HTTPS_PORT: 8080
      # CMDBIN: "aggrless"
      # DEBUG_PORT: 9229
    replicas: 1
  dashboardserve:
    serviceImage: devdocker.infra.kube/cryptopay/dashboard-ui
    tag: master.8bb17518
  gateuiserve:
    serviceImage: devdocker.infra.kube/cryptopay/gate-ui
    tag: master.f005f0ca

ingress:
  API:
    type: internal
    domain: api-evolution-cryptopay.dev.kube
    certSecretName: dev
    nginxConfigurationSnippet: |
      rewrite ^/$ /v2/time redirect;
    paths:
      "/":
        backendServiceName: processing
        backendServicePort: 8080
  Dashboard:
    type: internal
    domain: dashboard-evolution-cryptopay.dev.kube
    certSecretName: dev
    nginxConfigurationSnippet: |
      add_header Last-Modified $date_gmt;
      add_header Cache-Control 'no-store, no-cache, must-revalidate, proxy-revalidate, max-age=0';
      if_modified_since off;
      expires off;
      etag off;
    paths:
      "/":
        backendServiceName: dashboardserve
        backendServicePort: 8080
      "/v2/dashboard/":
        backendServiceName: processing
        backendServicePort: 8082
  Gate:
    type: internal
    domain: gate-evolution-cryptopay.dev.kube
    certSecretName: dev
    nginxConfigurationSnippet: |
      add_header Last-Modified $date_gmt;
      add_header Cache-Control 'no-store, no-cache, must-revalidate, proxy-revalidate, max-age=0';
      if_modified_since off;
      expires off;
      etag off;
    paths:
      "/":
        backendServiceName: gateuiserve
        backendServicePort: 8080
      "/v2/gate/":
        backendServiceName: processing
        backendServicePort: 8085
      "/v2/gate-callback/":
        backendServiceName: processing
        backendServicePort: 8085
  SpecsAndWtf2PssCallbacks:
    type: internal
    domain: evolution-cryptopay.dev.kube
    certSecretName: dev
    paths:
      "/":
        backendServiceName: processing
        backendServicePort: 8083
      "/v2/callback/cryptoproviders/":
        backendServiceName: processing
        backendServicePort: 8084
